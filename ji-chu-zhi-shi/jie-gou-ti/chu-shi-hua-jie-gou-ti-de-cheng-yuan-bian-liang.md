# 初始化结构体的成员变量

结构体在实例化时可以直接对成员变量进行初始化 , 初始化有两种形式分别是以字段“键值对”形式和多个值的列表形式 , 键值对形式的初始化适合选择性填充字段较多的结构体 , 多个值的列表形式适合填充字段较少的结构体 .

#### 使用“键值对”初始化结构体

结构体可以使用“键值对”\(Key value pair\)初始化字段 , 每个“键”\(Key\)对应结构体中的一个字段 , 键的“值”\(Value\)对应字段需要初始化的值 .

键值对的填充是可选的 , 不需要初始化的字段可以不填入初始化列表中 .

结构体实例化后字段的默认值是字段类型的默认值 , 例如 , 数值为 0、字符串为 ""\(空字符串\)、布尔为 false、指针为 nil 等 .

##### 键值对初始化结构体的书写格式

```go
ins := 结构体类型名{
    字段1: 字段1的值,
    字段2: 字段2的值,
    …
}
```

下面是对各个部分的说明 :

* **结构体类型** : 定义结构体时的类型名称 . 
* **字段1、字段2** : 结构体成员的字段名 , 结构体类型名的字段初始化列表中 , 字段名只能出现一次 . 
* **字段1的值、字段2的值** : 结构体成员字段的初始值 . 

键值之间以`:`分隔 , 键值对之间以`,`分隔 .

##### 使用键值对填充结构体的例子

下面示例中描述了家里的人物关联 , 正如儿歌里唱的 : “爸爸的爸爸是爷爷” , 人物之间可以使用多级的 child 来描述和建立关联 , 使用键值对形式填充结构体的代码如下 :

```go
type People struct {
    name  string
    child *People
}
relation := &People{
    name: "爷爷",
    child: &People{
        name: "爸爸",
        child: &People{
                name: "我",
        },
    },
}
```

提示 : 结构体成员中只能包含结构体的指针类型 , 包含非指针类型会引起编译错误 .

#### 使用多个值的列表初始化结构体

Go语言可以在“键值对”初始化的基础上忽略“键” , 也就是说 , 可以使用多个值的列表初始化结构体的字段 .

##### 多个值列表初始化结构体的书写格式

```go
ins := 结构体类型名{
    字段1的值,
    字段2的值,
    …
}
```

使用这种格式初始化时 , 需要注意 :

* 必须初始化结构体的所有字段 . 
* 每一个初始值的填充顺序必须与字段在结构体中的声明顺序一致 . 
* 键值对与值列表的初始化形式不能混用 . 

##### 多个值列表初始化结构体的例子

```go
type Address struct {
    Province    string
    City        string
    ZipCode     int
    PhoneNumber string
}
addr := Address{
    "四川",
    "成都",
    610000,
    "0",
}
fmt.Println(addr)
```

#### 初始化匿名结构体

匿名结构体没有类型名称 , 无须通过 type 关键字定义就可以直接使用 .

##### 匿名结构体定义格式和初始化写法

匿名结构体的初始化写法由结构体定义和键值对初始化两部分组成 , 结构体定义时没有结构体类型名 , 只有字段和类型定义 , 键值对初始化部分由可选的多个键值对组成 , 如下格式所示 :

```go
ins := struct {
    // 匿名结构体字段定义
    字段1 字段类型1
    字段2 字段类型2
    …
}{
    // 字段值初始化
    初始化字段1: 字段1的值,
    初始化字段2: 字段2的值,
    …
}
```

##### 使用匿名结构体的例子

```go
package main

import "fmt"

func printMsgType(msg *struct{
	id int
	data string
}) {
	// 使用动词%T打印msg的类型
	fmt.Printf("%T\n", msg)
	fmt.Print(msg.id,msg.data)
}

func main() {
	// 实例化一个匿名结构体
	msg := &struct {
		id int
		data string
	}{
		1024,
		"hello",
	}

	printMsgType(msg)
}
```



